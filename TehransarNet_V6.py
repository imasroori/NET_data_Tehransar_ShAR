import time

import requests
from datetime import datetime

from beepy import beep
from xlwt import Workbook
from time import sleep

## part1 : 129 segment   and   part2 : 169 segment
routs = [('35.704724485549754, 51.2675526882727', '35.70275550525978, 51.267209365520706'),  # (1,2)
         ('35.70275550525978, 51.267209365520706', '35.7014312079791, 51.26686604276872'),  # (2,3)
         ('35.7014312079791, 51.26686604276872', '35.70026371713311, 51.26654417768871'),  # (3,4)

         ('35.70026371713311, 51.26654417768871', '35.69988792329992, 51.2664674529931'),  # (4,4.1)
         ('35.69988792329992, 51.2664674529931', '35.699610310265555, 51.26638805394275'),  # (4.1,5)
         ('35.699610310265555, 51.26638805394275', '35.69925308657439, 51.26630222325293'),  # (5,5.1)
         ('35.69925308657439, 51.26630222325293', '35.698346904044875, 51.265964820544724'),  # (5.1,6)

         ('35.70520966896969, 51.265032421379274', '35.70276274454363, 51.26432871788017'),  # (7,8)
         ('35.70276274454363, 51.26432871788017', '35.70188359168081, 51.26409415004714'),  # (8,9)
         ('35.70188359168081, 51.26409415004714', '35.700769984138, 51.26371523277839'),  # (9,10)

         ('35.700813942625345, 51.26321000975339', '35.700213174534, 51.26306566031768'),  # (11,12)
         ('35.700213174534, 51.26306566031768', '35.699539136653016, 51.262903267202496'),  # (12,13)
         ('35.699539136653016, 51.262903267202496', '35.69873321431618, 51.26265065569'),  # (13,14)
         ('35.70571910054867, 51.262457632040864', '35.70448100339172, 51.26206969292413'),  # (15,16)
         ('35.70448100339172, 51.26206969292413', '35.703466335468526, 51.26180805956635'),  # (16,17)

         ('35.703466335468526, 51.26180805956635', '35.70270219293096, 51.26154601681445'),  # (17,18)
         ('35.70270219293096, 51.26154601681445', '35.702042828691894, 51.2613746018559'),  # (18,19)
         ('35.702042828691894, 51.2613746018559', '35.7012222789124, 51.261167099537644'),  # (19,20)

         ('35.70608309578467, 51.259994253404685', '35.705453459289, 51.25982799031876'),  # (21,21.1)

         ('35.705453459289, 51.25982799031876', '35.7045759545532, 51.25955432712718'),  # (21.1,22)
         ('35.7045759545532, 51.25955432712718', '35.70351305774843, 51.25925391971278'),  # (22,23)
         ('35.70351305774843, 51.25925391971278', '35.702554696021814, 51.258953512298405'),  # (23,24)
         ('35.702554696021814, 51.258953512298405', '35.70170087314373, 51.25867456255647'),  # (24,25)
         ('35.70170087314373, 51.25867456255647', '35.70096901768499, 51.258481443504365'),  # (25,26)
         ('35.70096901768499, 51.258481443504365', '35.70032428231038, 51.25833123979718'),  # (26,27)
         ('35.70032428231038, 51.25833123979718', '35.699574988703375, 51.25811666307261'),  # (27,28)

         ('35.706568073648576, 51.25690255133189', '35.70476697861888, 51.25662559588599'),  # (29,30) ----> 27 omin
         ('35.70476697861888, 51.25662559588599', '35.704192274917126, 51.25648853182799'),  # (30,30.1)
         ('35.704192274917126, 51.25648853182799', '35.70309369132757, 51.256201673919556'),  # (30.1,31)
         ('35.70309369132757, 51.256201673919556', '35.70221809305342, 51.2558368934878'),  # (31,32)
         ('35.70221809305342, 51.2558368934878', '35.70138772324707, 51.25540977075165'),  # (32,33)
         ('35.70138772324707, 51.25540977075165', '35.700206556233184, 51.25489941841653'),  # (33,34)

         ('35.69820968680749, 51.26611179704145', '35.69733566405803, 51.265881276550374'),  # (6,35)
         ('35.69733566405803, 51.265881276550374', '35.69554610509427, 51.2653832539307'),  # (35,36)
         ('35.69554610509427, 51.2653832539307', '35.69393586017598, 51.26495873360874'),  # (36,37)
         ('35.69393586017598, 51.26495873360874', '35.69143016379314, 51.26424981324675'),  # (37,38)

         ('35.69778394465266, 51.26568408146567', '35.69681278357278, 51.26549780427884'),  # (39,40) Edited in V3
         ('35.69681278357278, 51.26549780427884', '35.69588064044385, 51.26526341113634'),  # (40,41)
         ('35.69588064044385, 51.26526341113634', '35.69493791186073, 51.26499715832577'),  # (41,42)
         ('35.69493791186073, 51.26499715832577', '35.69356963749726, 51.26464485797672'),  # (42,43)
         ('35.69356963749726, 51.26464485797672', '35.69145640412029, 51.263994023749966'),  # (43,44)   ------> 41 omin

         ('35.697892629628534, 51.26462354644628', '35.696996774338395, 51.26430842122809'),  # (45,46)
         ('35.696996774338395, 51.26430842122809', '35.695618305764626, 51.263946772488545'),  # (46,47)
         ('35.695618305764626, 51.263946772488545', '35.69470279719281, 51.263692215734075'),  # (47,48)
         ('35.69470279719281, 51.263692215734075', '35.69376011949741, 51.26345447799536'),  # (48,49)
         ('35.69376011949741, 51.26345447799536', '35.691639847138894, 51.26284879644731'),  # (49,50)

         ('35.69722709526873, 51.25988416700688', '35.69602350490557, 51.259513702532566'),  # (52,53)
         ('35.69602350490557, 51.259513702532566', '35.69478510933379, 51.2591723130591'),  # (53,54)
         ('35.69478510933379, 51.2591723130591', '35.69379882310467, 51.258904835753135'),  # (54,55)
         ('35.69379882310467, 51.258904835753135', '35.69226673092393, 51.25848620533741'),  # (55,56)

         ('35.700206556233184, 51.25489941841653', '35.699024627309456, 51.25453915540471'),  # (34,57)
         ('35.699024627309456, 51.25453915540471', '35.69760070087041, 51.25418698427347'),  # (57,58)
         ('35.69760070087041, 51.25418698427347', '35.696281769938544, 51.254066113057405'),  # (58,59)
         ('35.696281769938544, 51.254066113057405', '35.69474966714355, 51.25412190125725'),  # (59,60)
         ('35.69474966714355, 51.25412190125725', '35.69299512818435, 51.25409680075729'),  # (60,61)

         ('35.7023559243601, 51.253190298372196', '35.701319467410876, 51.25284155057518'),  # (62,63)
         ('35.701319467410876, 51.25284155057518', '35.70012595567147, 51.25243685106523'),  # (63,64)
         ('35.70012595567147, 51.25243685106523', '35.698172109367405, 51.25194332460788'),  # (64,65) ----> 59 omin
         ('35.698172109367405, 51.25194332460788', '35.6962645200156, 51.25153601504008'),  # (65,66)
         ('35.6962645200156, 51.25153601504008', '35.693402149233364, 51.251598018879854'),  # (66,67)

         ('35.69130264781202, 51.264433033014626', '35.692651159516004, 51.26481685813159'),  # (68,69)
         ('35.692651159516004, 51.26481685813159', '35.695554117039855, 51.26557549880288'),  # (69,70)
         ('35.695554117039855, 51.26557549880288', '35.698206843489054, 51.266300467184436'),  # (70,71)
         ('35.698206843489054, 51.266300467184436', '35.701432030107874, 51.26710392919301'),  # (71,72)
         ('35.701432030107874, 51.26710392919301', '35.70461435955862, 51.26801102333393'),  # (72,73)

         ('35.691996469806014, 51.260828113871405', '35.6932764977336, 51.261173296560564'),  # (79,80)
         ('35.6932764977336, 51.261173296560564', '35.69509028150267, 51.26179316561764'),  # (80,81)

         ('35.69233666607865, 51.25855056914288', '35.693112533045884, 51.25875311522249'),  # (84,84.1) ---> 76 omin
         ('35.693112533045884, 51.25875311522249', '35.69412759188861, 51.259013837542376'),  # (84.1,85)
         ('35.69412759188861, 51.259013837542376', '35.695267418818375, 51.259364710054804'),  # (85,86)
         ('35.695267418818375, 51.259364710054804', '35.697024247375026, 51.25986707324714'),  # (86,87)
         ('35.697024247375026, 51.25986707324714', '35.69782168847707, 51.26010091960316'),  # (87,87.1)
         ('35.69782168847707, 51.26010091960316', '35.69830478031691, 51.26024147165581'),  # (87.1,87.2)
         ('35.69830478031691, 51.26024147165581', '35.6987443776905, 51.26037228833192'),  # (87.2,88)

         ('35.692971811881044, 51.25423858375103', '35.69467566212452, 51.25426653338282'),  # (89,90)
         ('35.69467566212452, 51.25426653338282', '35.69687271043802, 51.254222938551294'),  # (90,91)   ---> 84 omin
         ('35.69687271043802, 51.254222938551294', '35.69893691624642, 51.25463813323402'),  # (91,92)
         ('35.69893691624642, 51.25463813323402', '35.70053131584654, 51.255245078219126'),  # (92,93)
         ('35.70053131584654, 51.255245078219126', '35.702053079234275, 51.255962230324634'),  # (93,94)
         ('35.702053079234275, 51.255962230324634', '35.70312847082005, 51.256310993581906'),  # (94,95)
         ('35.70312847082005, 51.256310993581906', '35.7048327905993, 51.256727891518786'),  # (95,96)
         ('35.7048327905993, 51.256727891518786', '35.70627219604708, 51.257243517540644'),  # (96,97)

         ('35.69343163189469, 51.251596385028556', '35.694855578362294, 51.251543954280365'),  # (98,99)
         ('35.694855578362294, 51.251543954280365', '35.69696993034137, 51.25167740133442'),  # (99,100)
         ('35.69696993034137, 51.25167740133442', '35.69904306284601, 51.25215617564217'),  # (100,101)
         ('35.69904306284601, 51.25215617564217', '35.7008366334486, 51.25267911983541'),  # (101,102)
         ('35.7008366334486, 51.25267911983541', '35.702485554219486, 51.25322847155626'),  # (102,103)

         ('35.69954496578184, 51.25816766972383', '35.70160420342581, 51.258780485519196'),  # (104,105)
         ('35.702418457392376, 51.25901438202286', '35.70417467347206, 51.25947108878439'),  # (106,107)
         ('35.70417467347206, 51.25947108878439', '35.70613375514459, 51.26003481539831'),  # (107,108)

         ('35.701169581272055, 51.261303955362116', '35.70226660099453, 51.26159564819467'),  # (109,110)
         ('35.70226660099453, 51.26159564819467', '35.703266968263925, 51.26189658699315'),  # (110,111)
         ('35.703266968263925, 51.26189658699315', '35.705682453425034, 51.26259779563427'),  # (111,112)

         ('35.70071030503896, 51.26378123219496', '35.70181376454709, 51.26415850418118'),  # (113,114)
         ('35.70181376454709, 51.26415850418118', '35.7030890144574, 51.26451506651821'),  # (114,115)
         ('35.7030890144574, 51.26451506651821', '35.70522389731453, 51.265067272856854'),  # (115,116)

         ('35.70020517049686, 51.26651029692517', '35.70045169940415, 51.265122423116914'),  # (117,118)
         ('35.70045169940415, 51.265122423116914', '35.70078622595113, 51.26314824030987'),  # (118,119)
         ('35.70078622595113, 51.26314824030987', '35.70102172933547, 51.2620489168147'),  # (119,119.1)
         ('35.70102172933547, 51.2620489168147', '35.701152650635606, 51.261309644889735'),  # (119.1,120)
         ('35.701152650635606, 51.261309644889735', '35.7013465786173, 51.26020058720107'),  # (120,120.1)
         ('35.7013465786173, 51.26020058720107', '35.701654789475775, 51.25875686479617'),  # (120.1,121)

         ('35.70223318951958, 51.25570664863733', '35.70236515600293, 51.25446961774549'),  # (122,123)
         ('35.70236515600293, 51.25446961774549', '35.7025093520091, 51.25323653025389'),  # (123,124)

         ('35.698054168251325, 51.26605530013621', '35.698394304994736, 51.264263584513635'),  # (125,126)
         ('35.698394304994736, 51.264263584513635', '35.698835096815415, 51.26176170669377'),  # (126,127)
         ('35.698835096815415, 51.26176170669377', '35.6994884542515, 51.25813807832524'),  # (127,128) --- 116 omin
         ('35.6994884542515, 51.25813807832524', '35.70026301189498, 51.25513221536672'),  # (128,129)

         ('35.694078154488075, 51.26460313265959', '35.69465111066439, 51.26152414425334'),  # (130,131)
         ('35.69465111066439, 51.26152414425334', '35.694948009815846, 51.259333839693205'),  # (131,132)
         ('35.694948009815846, 51.259333839693205', '35.695260128427336, 51.25668185913501'),  # (132,133)
         ('35.695260128427336, 51.25668185913501', '35.69554016439757, 51.25389468513049'),  # (133,134)
         ('35.69554016439757, 51.25389468513049', '35.69566526357753, 51.251622620879814'),  # (134,135)

         ('35.69551200920652, 51.2542459282353', '35.69538828352607, 51.255253473635435'),  # (137,138)
         ('35.69538828352607, 51.255253473635435', '35.69508040437586, 51.25797881961929'),  # (138,139)
         ('35.69508040437586, 51.25797881961929', '35.69477514349466, 51.26068555320796'),  # (139,140)
         ('35.69477514349466, 51.26068555320796', '35.694404262092874, 51.26271630791575'),  # (140,141)
         ('35.694404262092874, 51.26271630791575', '35.694242376898934, 51.263562862359926'),  # (141,141.1)  ->128 omin

         ('35.694242376898934, 51.263562862359926', '35.69412880806295, 51.26417296427511'),  # (141.1,141.2)
         ('35.69412880806295, 51.26417296427511', '35.69403451848157, 51.26466035798462'),  # (141.2,142)

         ('35.69997022690067, 51.255062670842385', '35.69937970832748, 51.25794838654303'),  # (143,144)
         ('35.69937970832748, 51.25794838654303', '35.698942593309305, 51.260181561791484'),  # (144,145)
         ('35.698942593309305, 51.260181561791484', '35.698551877555886, 51.26242565857365'),  # (145,146)
         ('35.698551877555886, 51.26242565857365', '35.69793121730023, 51.26594391291479'),  # (146,147)

         ('35.702094290921295, 51.25620057180521', '35.70159624303803, 51.258585172958185'),  # (148,149)
         ('35.70159624303803, 51.258585172958185', '35.701520051771006, 51.25929744934149'),  # (149,150)
         ('35.701520051771006, 51.25929744934149', '35.70107559746686, 51.26166055872477'),  # (150,151)
         ('35.70107559746686, 51.26166055872477', '35.70067452485161, 51.2637719251733'),  # (151,152)
         ('35.70067452485161, 51.2637719251733', '35.70018305148624, 51.266482836750974'),  # (152,153)

         ##############################################################################
         ##==========================> start part 2 in here <============================##
         ##############################################################################

         ('35.691196339573104, 51.26418074433318', '35.69021822379051, 51.26394739214953'),  # (1,2)
         ('35.69021822379051, 51.26394739214953', '35.68912144933277, 51.26366017483941'),  # (2,3)
         ('35.68912144933277, 51.26366017483941', '35.68794126745889, 51.26332907546951'),  # (3,4)
         ('35.68794126745889, 51.26332907546951', '35.68682444271111, 51.26301992833676'),  # (4,5)
         ('35.68682444271111, 51.26301992833676', '35.684915603477066, 51.26247590794303'),  # (5,6)

         ('35.69141628009587, 51.26278894466321', '35.69089563787823, 51.26267763298875'),  # (7,8)
         ('35.69089563787823, 51.26267763298875', '35.69042195324135, 51.26253949922524'),  # (8,9)

         ('35.69040353423987, 51.261632057836465', '35.68951473938536, 51.261418236996285'),  # (10,11)
         ('35.68951473938536, 51.261418236996285', '35.68865902891985, 51.2612387796019'),  # (11,12)

         ('35.68841095996577, 51.26170687447206', '35.6878166047849, 51.26159908936569'),  # (13,14)  13 Edited in V3
         ('35.6878166047849, 51.26159908936569', '35.687062836578455, 51.26143547461721'),  # (14,15)

         ('35.69173738042191, 51.26072508778927', '35.6911905493827, 51.260540168492085'),  # (16,17)
         ('35.6911905493827, 51.260540168492085', '35.690660217716356, 51.26037468505016'),  # (17,18)

         ('35.69203689839396, 51.25843145428257', '35.69152337359636, 51.25828431084604'),  # (19,20)
         ('35.69152337359636, 51.25828431084604', '35.69061188649267, 51.258206430066984'),  # (20,21)
         ('35.69061188649267, 51.258206430066984', '35.68946761127424, 51.25794136379589'),  # (21,22)
         ('35.68946761127424, 51.25794136379589', '35.68848511730828, 51.25770848405631'),  # (22,23)
         ('35.68848511730828, 51.25770848405631', '35.68762218944669, 51.257503998822166'),  # (23,24)

         ('35.69278538508544, 51.25403128336341', '35.691700975811656, 51.25382075985533'),  # (25,26)
         ('35.691700975811656, 51.25382075985533', '35.690064136074405, 51.25449384597398'),  # (26,27)
         ('35.690064136074405, 51.25449384597398', '35.68797291417257, 51.25553087897744'),  # (27,28)
         ('35.68797291417257, 51.25553087897744', '35.686899190643054, 51.25528218778811'),  # (28,29)

         ('35.6924895699317, 51.25238508574797', '35.69189606634773, 51.25225877999128'),  # (30,31)
         ('35.69189606634773, 51.25225877999128', '35.69101862548618, 51.252053533136454'),  # (31,32)
         ('35.69101862548618, 51.252053533136454', '35.68990889699391, 51.251754541491536'),  # (32,33)
         ('35.68990889699391, 51.251754541491536', '35.68862202764703, 51.25143422987236'),  # (33,34)

         ('35.69361847606937, 51.24911514705708', '35.69324494577327, 51.2490070403911'),  # (35,36)
         ('35.69324494577327, 51.2490070403911', '35.6923555148075, 51.24877742540562'),  # (36,37)
         ('35.6923555148075, 51.24877742540562', '35.69138191314398, 51.24849209597164'),  # (37,38)
         ('35.69138191314398, 51.24849209597164', '35.69052219283156, 51.24824305419455'),  # (38,39)
         ('35.69052219283156, 51.24824305419455', '35.68918204460643, 51.24788269863939'),  # (39,40)

         ('35.693924780552535, 51.247430173715365', '35.69309733740047, 51.247218394854166'),  # (41,42)
         ('35.69309733740047, 51.247218394854166', '35.69190627522721, 51.24687519905085'),  # (42,43)
         ('35.69190627522721, 51.24687519905085', '35.691585505353245, 51.24679406222797'),  # (43,44)
         ('35.691585505353245, 51.24679406222797', '35.691184677349675, 51.246694820494234'),  # (44,45)
         ('35.691184677349675, 51.246694820494234', '35.69042168260078, 51.246484937639046'),  # (45,46)
         ('35.69042168260078, 51.246484937639046', '35.68950420131358, 51.24620813390097'),  # (46,47)

         ('35.694179460348145, 51.245734489330026', '35.69339206949427, 51.24555602176004'),  # (48,49)
         ('35.69339206949427, 51.24555602176004', '35.69247525555455, 51.24529741756621'),  # (49,50)
         ('35.69247525555455, 51.24529741756621', '35.691709093287535, 51.24509806947631'),  # (50,51)
         ('35.691709093287535, 51.24509806947631', '35.69072167086981, 51.24484948142295'),  # (51,52)
         ('35.69072167086981, 51.24484948142295', '35.68968493135823, 51.244578054459424'),  # (52,53)

         ('35.69200256128315, 51.24352060462591', '35.69147218842984, 51.243382152229174'),  # (54,55)
         ('35.69147218842984, 51.243382152229174', '35.69072421826298, 51.243172915622985'),  # (55,56)
         ('35.69072421826298, 51.243172915622985', '35.689959219726056, 51.242981218189804'),  # (56,57)

         ('35.68581674691188, 51.26293616578259', '35.68683308093063, 51.26320547848855'),  # (58,59)
         ('35.68683308093063, 51.26320547848855', '35.68796238452825, 51.26350537067746'),  # (59,60)
         ('35.68796238452825, 51.26350537067746', '35.689689064381895, 51.2639703806204'),  # (60,61)
         ('35.689689064381895, 51.2639703806204', '35.691275815237255, 51.26441374920566'),  # (61,62)

         ('35.687072806588766, 51.261479380677756', '35.68772420904328, 51.26161791934599'),  # (63,64)
         ('35.68772420904328, 51.26161791934599', '35.68840672398918, 51.26177814491108'),  # (64,65)

         ('35.68871277068928, 51.261399670483655', '35.68949282936474, 51.26144266144828'),  # (66,67) 66 edited in v4
         ('35.68949282936474, 51.26144266144828', '35.69040281994479, 51.26166318990488'),  # (67,68)

         ('35.69110461901918, 51.260635139942806', '35.69173306056519, 51.26075572146791'),  # (73,74)

         ('35.68770033538182, 51.25768892515207', '35.688321338577346, 51.25768427411087'),  # (75,76)
         ('35.688321338577346, 51.25768427411087', '35.68877000133679, 51.257806539023015'),  # (76,76.1)
         ('35.68877000133679, 51.257806539023015', '35.68903793455027, 51.257888912824974'),  # (76.1,77)
         ('35.68903793455027, 51.257888912824974', '35.68936890832511, 51.257966107143524'),  # (77,77.1)
         ('35.68936890832511, 51.257966107143524', '35.68965491191546, 51.258022240525605'),  # (77.1,77.2)
         ('35.68965491191546, 51.258022240525605', '35.690101259143184, 51.25813034167767'),  # (77.2,78)
         ('35.690101259143184, 51.25813034167767', '35.69057017557068, 51.25823598380119'),  # (78,78.1)
         ('35.69057017557068, 51.25823598380119', '35.69097536350927, 51.258268170309755'),  # (78.1,79)
         ('35.69097536350927, 51.258268170309755', '35.692066721084515, 51.258461323103596'),  # (79,80)

         ('35.68793380959268, 51.25591577195287', '35.689401465890136, 51.25519853569243'),  # (81,82)
         ('35.689401465890136, 51.25519853569243', '35.690588028661914, 51.25438608873705'),  # (82,83)
         ('35.690588028661914, 51.25438608873705', '35.692716531197895, 51.254199954855856'),  # (83,84)

         ('35.688541993602584, 51.251658364063275', '35.68941935177406, 51.251848973185595'),  # (85,86)
         ('35.68941935177406, 51.251848973185595', '35.69049292973548, 51.25208552533318'),  # (86,87)
         ('35.69049292973548, 51.25208552533318', '35.69244432239788, 51.252565273610465'),  # (87,88)

         ('35.68913620521243, 51.24790172456213', '35.6895821213978, 51.24800596885346'),  # (89,90)
         ('35.6895821213978, 51.24800596885346', '35.69033691386221, 51.24821994757925'),  # (90,90.1)
         ('35.69033691386221, 51.24821994757925', '35.691163986699245, 51.248467327035875'),  # (90.1,91)
         ('35.691163986699245, 51.248467327035875', '35.69242779417949, 51.24882140931454'),  # (91,92)
         ('35.69242779417949, 51.24882140931454', '35.6936138953217, 51.24913033533572'),  # (92,93)

         ('35.689374298672064, 51.24659730741963', '35.68997208757546, 51.2465039804366'),  # (94,95)
         ('35.68997208757546, 51.2465039804366', '35.69055110322575, 51.246627524370155'),  # (95,96)
         ('35.69055110322575, 51.246627524370155', '35.69112915396541, 51.2467797869446'),  # (96,97)
         ('35.69112915396541, 51.2467797869446', '35.69162842591665, 51.246924988968104'),  # (97,98)
         ('35.69162842591665, 51.246924988968104', '35.69264068121143, 51.24724226631665'),  # (98,99)
         ('35.69264068121143, 51.24724226631665', '35.693905993049796, 51.24756810132909'),  # (99,100)

         ('35.689667602407646, 51.24474227211527', '35.6906685556378, 51.24499565320965'),  # (101,102)
         ('35.6906685556378, 51.24499565320965', '35.69138973077639, 51.245196732188404'),  # (102,103)
         ('35.69138973077639, 51.245196732188404', '35.69285053446556, 51.2455517428731'),  # (103,104)
         ('35.69285053446556, 51.2455517428731', '35.69417121896389, 51.24587234915884'),  # (104,105)

         ('35.68994610006382, 51.24300159736299', '35.69092813234163, 51.24326346005932'),  # (106,107)
         ('35.69092813234163, 51.24326346005932', '35.692000003200775, 51.24354173520769'),  # (107,108)

         ('35.69037828879272, 51.24096356243164', '35.69085509432909, 51.24144642643785'),  # (109,110)
         ('35.69085509432909, 51.24144642643785', '35.69159830167406, 51.24228150801052'),  # (110,111)
         ('35.69159830167406, 51.24228150801052', '35.692137276080764, 51.24287901784074'),  # (111,112)

         ('35.692383260809834, 51.24317989320537', '35.69277536928601, 51.243607705541834'),  # (113,114)
         ('35.69277536928601, 51.243607705541834', '35.69346941813373, 51.24433599766167'),  # (114,115)
         ('35.69346941813373, 51.24433599766167', '35.694185875666754, 51.245104620736434'),  # (115,116)

         ('35.689605924567665, 51.23980387177615', '35.69039417544634, 51.24069566838891'),  # (117,118)
         ('35.69039417544634, 51.24069566838891', '35.691582870598594, 51.24207594325608'),  # (118,119)
         ('35.691582870598594, 51.24207594325608', '35.692666390578246, 51.24322929029841'),  # (119,120)
         ('35.692666390578246, 51.24322929029841', '35.693593689059824, 51.2442514862692'),  # (120,121)
         ('35.693593689059824, 51.2442514862692', '35.69441442582759, 51.24515664252932'),  # (121,122)

         ('35.6914123775304, 51.26414043137383', '35.69170581537384, 51.26227926780279'),  # (123,124)
         ('35.69170581537384, 51.26227926780279', '35.692006601838436, 51.26021694081488'),  # (124,125)
         ('35.692006601838436, 51.26021694081488', '35.692328843177854, 51.25795715116676'),  # (125,126)
         ('35.692328843177854, 51.25795715116676', '35.69286624931618, 51.25466753627564'),  # (126,127)
         ('35.69286624931618, 51.25466753627564', '35.69335697417836, 51.25180093453644'),  # (127,128)
         ('35.69335697417836, 51.25180093453644', '35.693859917487956, 51.24920577777775'),  # (128,129)
         ('35.693859917487956, 51.24920577777775', '35.694464128766526, 51.24577505347846'),  # (129,130)

         ('35.69049671537211, 51.261665257089184', '35.69067044013096, 51.26005273175944'),  # (132,133)
         ('35.69067044013096, 51.26005273175944', '35.69091274224988, 51.258308968890766'),  # (133,134)
         ('35.69091274224988, 51.258308968890766', '35.69141226171187, 51.25635582259642'),  # (134,135)
         ('35.69141226171187, 51.25635582259642', '35.69168549041527, 51.25422297701029'),  # (135,136)

         ('35.69231196257213, 51.253851621718255', '35.692562336823286, 51.25245539393337'),  # (137,138)

         ('35.688640211128565, 51.261710389461065', '35.688677480387014, 51.26083846461394'),
         # (141,142) 141 edited in v4
         ('35.688677480387014, 51.26083846461394', '35.68884187034534, 51.259665386898725'),  # (142,143)
         ('35.68884187034534, 51.259665386898725', '35.68911975287581, 51.25773968177317'),  # (143,144)
         ('35.68911975287581, 51.25773968177317', '35.689534303006894, 51.25522505291987'),  # (144,145)

         ('35.69074245802425, 51.25192435649782', '35.69102856469579, 51.25035484221951'),  # (146,147)
         ('35.69102856469579, 51.25035484221951', '35.691361210085596, 51.24834937269301'),  # (147,148)
         ('35.691361210085596, 51.24834937269301', '35.69189310032553, 51.24536194701764'),  # (148,149)
         ('35.69189310032553, 51.24536194701764', '35.69230292081527, 51.243148662231675'),  # (149,150)

         ('35.69211791749717, 51.243801347195394', '35.69295559041224, 51.24187913629654'),  # (151,152)

         ('35.686776908175524, 51.262934299295736', '35.687129135733855, 51.260519376780934'),  # (153,154)
         ('35.687129135733855, 51.260519376780934', '35.68757311289508, 51.257547993880905'),  # (154,155)
         ('35.68757311289508, 51.257547993880905', '35.68811441424218, 51.253828612264336'),  # (155,156)
         ('35.68811441424218, 51.253828612264336', '35.68858970476686, 51.250854264914004'),  # (156,157)
         ('35.68858970476686, 51.250854264914004', '35.68906538859349, 51.24786783275229'),  # (157,158)
         ('35.68906538859349, 51.24786783275229', '35.68939405794267, 51.24594042446294'),  # (158,159)
         ('35.68939405794267, 51.24594042446294', '35.68976794971517, 51.24366638570286'),  # (159,160)
         ('35.68976794971517, 51.24366638570286', '35.69018094558559, 51.24096194622983'),  # (160,161)
         ('35.69018094558559, 51.24096194622983', '35.689432169271164, 51.24021823816595'),  # (161,162)

         ('35.688862951342145, 51.24024157641035', '35.690051425266, 51.240901393125455'),  # (163,164)
         ('35.690051425266, 51.240901393125455', '35.689750516423885, 51.243016295292854'),  # (164,165)
         ('35.689750516423885, 51.243016295292854', '35.6892527372835, 51.24597611294121'),  # (165,166)
         ('35.6892527372835, 51.24597611294121', '35.688647609936865, 51.24942451909217'),  # (166,167)
         ('35.688647609936865, 51.24942451909217', '35.688074696976436, 51.25317412462988'),  # (167,168)
         ('35.688074696976436, 51.25317412462988', '35.687616553341535, 51.25616333362155'),  # (168,169)
         ('35.687616553341535, 51.25616333362155', '35.687063933286424, 51.25991456693465'),  # (169,170)
         ('35.687063933286424, 51.25991456693465', '35.686654612616785, 51.26288080846068'),  # (170,171)

         ('35.68784696813372, 51.254709893919916', '35.68717533392381, 51.25536043052306'),  # (172,173)

         ('35.68717803943573, 51.255459514347166', '35.6875745305326, 51.256363418780154'),  # (174,175)

         ('35.693081778641684, 51.24166930198818', '35.69217534735982, 51.24310070094936'),  # (176,177)
         ('35.69217534735982, 51.24310070094936', '35.69175177418327, 51.24531524863741'),  # (177,178)
         ('35.69175177418327, 51.24531524863741', '35.69134168875482, 51.2477426477954'),  # (178,179)
         ('35.69134168875482, 51.2477426477954', '35.69096456397152, 51.249924761363'),  # (179,180)
         ('35.69096456397152, 51.249924761363', '35.69063474206468, 51.25189058061128'),  # (180,181)

         ('35.689369545288, 51.25534186035297', '35.6892786731753, 51.256359378340555'),  # (182,183)
         ('35.6892786731753, 51.256359378340555', '35.68918320387505, 51.257067217298456'),  # (183,183.1)
         ('35.68918320387505, 51.257067217298456', '35.689082168235416, 51.25778808996161'),  # (183.1,184)
         ('35.689082168235416, 51.25778808996161', '35.68878372722219, 51.25983961650927'),  # (184,185)
         ('35.68878372722219, 51.25983961650927', '35.68849593139526, 51.2617261055922'),  # (185,186)

         ('35.69316713125312, 51.24913358575319', '35.69311920722287, 51.24939711278931'),  # (187,187.1)
         ('35.69311920722287, 51.24939711278931', '35.693078362856205, 51.249639182153274'),  # (187.1,187.2)
         ('35.693078362856205, 51.249639182153274', '35.693042964386784, 51.249865828814904'),  # (187.2,187.3)

         ('35.69258354794564, 51.25225388308503', '35.692266753658025, 51.253885037035474'),  # (190,191)

         ('35.69165894637408, 51.25411792177356', '35.69151768921351, 51.255145005115416'),  # (192,193)
         ('35.69151768921351, 51.255145005115416', '35.6913643743509, 51.25639170397712'),  # (193,194)
         ('35.6913643743509, 51.25639170397712', '35.69104542090166, 51.25813877554058'),  # (194,195)
         ('35.69104542090166, 51.25813877554058', '35.6906458019404, 51.260007045402936'),  # (195,196)
         ('35.6906458019404, 51.260007045402936', '35.690396629662686, 51.2622148502318'),  # (196,197)
         ('35.690396629662686, 51.2622148502318', '35.69012982108729, 51.2637164131546'),  # (197,198)

         ('35.69427964342521, 51.24536827601084', '35.6941292416183, 51.246349757413235'),  # (199,200)
         ('35.6941292416183, 51.246349757413235', '35.69396045212463, 51.247423764677436'),  # (200,201)
         ('35.69396045212463, 51.247423764677436', '35.69378366110159, 51.24855637258312'),  # (201,202)
         ('35.69378366110159, 51.24855637258312', '35.69348011980102, 51.249948030456096'),  # (202,203)
         ('35.69348011980102, 51.249948030456096', '35.69324143393792, 51.251551770895546'),  # (203,204)
         ('35.69324143393792, 51.251551770895546', '35.69288116292555, 51.253955803954376'),  # (204,205)
         ('35.69288116292555, 51.253955803954376', '35.69248576044024, 51.25579149423918'),  # (205,206)
         ('35.69248576044024, 51.25579149423918', '35.69222163562743, 51.257538086053565'),  # (206,207)
         ('35.69222163562743, 51.257538086053565', '35.69187700515854, 51.26000000746945'),  # (207,208)
         ('35.69187700515854, 51.26000000746945', '35.69163682179029, 51.261640260823874'),  # (208,209)
         ('35.69163682179029, 51.261640260823874', '35.69142379588541, 51.26303777287772'),  # (209,210)
         ('35.69142379588541, 51.26303777287772', '35.691253321996236, 51.264149090914934'),  # (210,211)

         # Added part1 segments in version 3
         ('35.69412965726401, 51.261375767400295', '35.69199923607123, 51.26078829767398'),  # (300,301)
         ('35.69153249757159, 51.26406974188294', '35.69353081951242, 51.26465270113462'),  # (302,303)
         ('35.69353081951242, 51.26465270113462', '35.69581906774126, 51.26529114064637'),  # (303,304)

         # Added part1 in Version 4

         ('35.69173737296817, 51.26300063274123', '35.69279594977309, 51.263276404744964'),  # (74,75)
         ('35.69279594977309, 51.263276404744964', '35.693708997037355, 51.26352931384301'),  # (75,75.1)
         ('35.693708997037355, 51.26352931384301', '35.69448851775927, 51.26372811455765'),  # (75.1,76)
         ('35.69448851775927, 51.26372811455765', '35.695548848963064, 51.26403934079747'),  # (76,77) ----> 70 omin
         ('35.695548848963064, 51.26403934079747', '35.69682835879781, 51.264376734496516'),  # (77,77.1)
         ('35.69682835879781, 51.264376734496516', '35.697532704036064, 51.26459873270825'),  # (77.1,77.2)
         ('35.697532704036064, 51.26459873270825', '35.69781446877916, 51.26466945258446'),  # (77.2,77.3)
         ('35.69781446877916, 51.26466945258446', '35.6980719692147, 51.26473157131455'),  # (77.3,78)

         ('35.69509028150267, 51.26179316561764', '35.69664582843555, 51.26218301543264'),  # (81,82)
         ('35.69664582843555, 51.26218301543264', '35.69759410485558, 51.26240565538107'),  # (82,82.1)
         ('35.69759410485558, 51.26240565538107', '35.698501046446346, 51.26262625633002'),  # (82.1,83)

         ('35.70160420342581, 51.258780485519196', '35.702418457392376, 51.25901438202286'),  # (105,106) ----> 97 omin

         # added Part2  in version 4

         ('35.69068287038015, 51.26057941301429', '35.69110461901918, 51.260635139942806'),  # (72,73)

         ('35.69023416381065, 51.263660423152395', '35.69049671537211, 51.261665257089184'),  # (131,132)

         ('35.69279593634637, 51.2514465168917', '35.69295457728306, 51.250395388803334'),  # (139,139.1)
         ('35.69295457728306, 51.250395388803334', '35.693118816820416, 51.24942209405505'),  # (139.1,140)

         ('35.692691447270334, 51.25168019106416', '35.69258354794564, 51.25225388308503'),  # (189,190)

         # Added to part 2 in version 5
         ('35.686888337411744, 51.2554164137093', '35.68802263762364, 51.25570734630109')  # (400,401)
         ]

headers = {"Api-Key": 'service.QgLr5hFhqhyz4G99kmP75gFaYziX3vYpFBhxynQj'}

url = 'https://api.neshan.org/v3/direction'

name_file_1 = str(datetime.now()).replace(':', '-').split('.')[0]

# Workbook is created
wb = Workbook()

# add_sheet is used to create sheet.
sheet1 = wb.add_sheet('Sheet 1')

sheet1.write(0, 0, "segment")
sheet1.write(0, 1, "segmentID")
sheet1.write(0, 2, "distance(m)")
sheet1.write(0, 3, "duration(s)")
sheet1.write(0, 4, "velocity(m/s)")
sheet1.write(0, 5, "time")

for i in range(10000):
    time_start = time.time()
    for j in range(1, len(routs) + 1):
        num_cell = len(routs) * i + j
        try:
            data = {
                'type': 'car',
                'origin': routs[j - 1][0],
                'destination': routs[j - 1][1],
            }
            query = requests.get(url, params=data, headers=headers)
            # print(query.json())
            num_cell = len(routs) * i + j
            distance = query.json()['routes'][0]['legs'][0]['distance']['value']
            duration = query.json()['routes'][0]['legs'][0]['duration']['value']
            sheet1.write(num_cell, 1, j)
            sheet1.write(num_cell, 2, distance)
            sheet1.write(num_cell, 3, duration)
            sheet1.write(num_cell, 4, distance / duration)
            sheet1.write(num_cell, 5, str(datetime.now()).split('.')[0])
            wb.save(name_file_1 + '.xls')
            print(f"data {num_cell} saved!")
            # sleep(1.7)  # Interval 1.7 seconds between requests

        except:
            beep(sound=3)
            print(f"ERROR in {num_cell} at {str(datetime.now()).split('.')[0]}")
            continue
    time_end = time.time()
    req_time = int(time_end - time_start)
    if req_time > 0:
        sleep(600 - req_time)
    else:
        continue
